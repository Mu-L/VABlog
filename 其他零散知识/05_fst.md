#面试题整理

- 什么是封装格式，视频的压缩数据是什么？

封装格式是指对音频、视频、字幕等通道进行封装成一个文件，比如：mp4、flv、rmvb等等；视频压缩的数据是指码流。

- 视频为什么需要进行编码，编码的意义是什么(那些内容何以压缩和编码)？

原始视频太大，不能有效的进行保存和传输，需要对原始数据进行压缩编码处理。编码能把数据进行很大力度的压缩处理，针对于视频中裸流数据YUV和音频的裸流数据PCM进行压缩和编码。


- 硬编码与软编码有什么区别？

硬编码是指使用DSP芯片等硬件设备进行编码，软编码是指使用CPU进行编码，而我们程序员中的CPU是进行算法运行的CPU，因为从物理上来说CPU会集成其他芯片比如手机高通CPU会把DSP芯片集成到CPU里面去。硬编码优点是速度快、不占用CPU资源，但是确实各大厂商的设备质量好坏不一，存在很大的兼容性问题。软编码是指使用CPU进行编码，优点是介绍兼容性问题，缺点是速度慢，影响CPU做其他运行。

- I帧  B帧 P帧的区别是什么？

I帧是关键帧，包含完整的图像信息，解码出来就能完全显示。码流数据很大。

B帧是双向预测帧，相似度在95%以内。需要依赖于I帧和P帧进行编解码。码流数据很小。

P帧是向前预测帧，相似度在70%以内。需要依赖I帧或者前一个P帧进行编解码。码流数据一般。


- 什么是GOP序列？

Group Of Picture，即一组图片数据。GOP是指同一个场景的数据，从一个I帧开始，到下一个I帧之前的一组码流数据。

- 解码顺序和播放顺序是一样的吗?

不一样。因为视频的编解码顺序中B帧是以P帧作为参考帧，而播放时间顺序中B是在I帧和P之间。

- 宏块是什么，为什么有宏块？

宏块是指在视频编码中一帧图片划分出来64x64、16x16、16x8、4x4等一个个小区域，为了在帧内加大压缩力度。因为划分的宏块中，宏块里面的内容都很相近，使用`视频信源编码器`进行编码过程中，只会获取宏块顶部和左侧的像素点，以及颜色变化的预测方向。而宏块越大，压缩的比例越大。

- 如何从码流片段中解析出完整一帧？

从起始码（00 00 00 01）中截切后面的一个NAL单元，判断第一个字节后5bit是否是IDR类型就是一个完整的I帧了。

- 讲讲短视频和直播参数应该如何调节的？

两者都是网络传输要求码流都比较小。

短视频中：是一个完整的文件，对细节有要求，所以fps(帧率)一般比较高，像抖音的可达到60帧。既然fps大了，那要求每个GOF（两个I帧间隔）比较长，即B帧的比较多。有些视频的GOF有十多秒。

直播：为了让新加入的的观众能尽快的看到画面，每个GOF则要求短，一般两秒一个I帧。但直播对fps感知并不高，15帧就好了。


- 即时通话如何保持音视频同步呢？

实时，把最新的推流过去就是最好的同步，也就是编码时把当前的时间戳作为音频和视频的pts即可。


- webrtc难点在哪？

P2P打洞技术。回音消除技术。


- 网络抖动时，如何优化使得播放更平滑？

使用缓存，就是先加载后面数据一段时间，如：网站视频播放。但是这跟实时通讯相冲突了。所以是一把双刃剑。

- RTMP和RTSP之间的应用场景？

RTMP用于直播；RTSP用于安防，需要保证每一帧画面不丢失。


- 直播会有B帧吗？为什么？

直播一般没有B帧，B帧需要参考I帧和P帧才能解码出来，有拿到B帧时还没收到P帧，照成无法解码，照成显示延迟。


- 直播连麦是怎么实现的？

直播 + 音视频通话


